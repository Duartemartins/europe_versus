<div class="max-w-7xl mx-auto px-6">
  <!-- Hero Section -->
  <section class="py-20 border-b-2 border-black">
    <h1 class="text-6xl md:text-9xl font-black tracking-tighter mb-8">
      METHOD<br>
      <span class="text-[#0066FF]">OLOGY</span>
    </h1>
    <p class="text-xl text-black/60 max-w-2xl">
      Understanding how we calculate Europe's aggregate statistics for accurate, transparent comparisons
    </p>
  </section>

  <!-- Overview Section -->
  <section class="py-16 border-b-2 border-black">
    <div class="grid md:grid-cols-3 gap-0">
      <div class="md:col-span-1 pr-8 border-r-2 border-black">
        <span class="font-mono text-xs uppercase tracking-brutal bg-black text-white px-3 py-1 inline-block mb-4">00</span>
        <h2 class="font-mono text-sm uppercase tracking-brutal font-bold">Why This Matters</h2>
      </div>
      <div class="md:col-span-2 pl-8 space-y-6">
        <p class="text-lg text-black/70">
          When comparing Europe with single countries like the USA, India, or China, we need a single aggregate number for Europe. 
          This requires careful calculation to ensure accuracy and fairness.
        </p>
        <div class="border-l-2 border-[#0066FF] pl-6">
          <p class="text-black font-bold">The key principle:</p>
          <p class="text-black/70">All metrics are <strong class="text-black">population-weighted</strong> to reflect the true European experience. A simple average would give Luxembourg the same weight as Germany, which wouldn't be representative.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- What is Europe Section -->
  <section class="py-16 border-b-2 border-black">
    <div class="flex items-center gap-6 mb-12">
      <span class="font-mono text-xs uppercase tracking-brutal bg-black text-white px-3 py-1">01</span>
      <h2 class="text-4xl font-black tracking-tighter">WHAT DEFINES "EUROPE"?</h2>
    </div>
    
    <div class="grid md:grid-cols-2 gap-0">
      <div class="border-2 border-black p-8">
        <h3 class="font-mono text-sm uppercase tracking-brutal font-bold mb-6 pb-4 border-b border-black">Countries Included</h3>
        <p class="text-black/70 mb-6">
          We include <strong class="text-[#0066FF]"><%= @european_countries.size %> European countries</strong> in our calculations, 
          representing a total population of <strong class="text-[#0066FF]"><%= number_to_human(@population_data.dig(:countries, 'europe', :value) || 0, precision: 3, format: '%n%u', units: { million: 'M', billion: 'B' }) %> people</strong>.
        </p>

        <% if @coverage.present? %>
          <div class="p-4 border-2 border-black mb-6 <%= @coverage[:with_both].size == @coverage[:total_european_countries] ? 'bg-[#F5F5F5]' : 'bg-[#FFCC00]/20' %>">
            <% total = @coverage[:total_european_countries] %>
            <% with_both = @coverage[:with_both].size %>
            <% missing_gdp = @coverage[:missing_gdp] %>
            <% missing_population = @coverage[:missing_population] %>
            <% missing_both = @coverage[:missing_both] %>
            <div class="font-mono text-sm font-bold mb-2">
              Data coverage: <%= with_both %>/<%= total %>
            </div>
            <% if with_both < total %>
              <div class="font-mono text-xs text-black/60">
                <% if missing_gdp.any? %>
                  Missing GDP: <%= missing_gdp.map { |c| EuropeanCountriesHelper.country_name(c) }.sort.join(', ') %>
                <% end %>
                <% if missing_population.any? %>
                  <% if missing_gdp.any? %><br><% end %>
                  Missing population: <%= missing_population.map { |c| EuropeanCountriesHelper.country_name(c) }.sort.join(', ') %>
                <% end %>
                <% if missing_both.any? %>
                  <% if missing_gdp.any? || missing_population.any? %><br><% end %>
                  Missing both: <%= missing_both.map { |c| EuropeanCountriesHelper.country_name(c) }.sort.join(', ') %>
                <% end %>
              </div>
            <% end %>
          </div>
        <% end %>
        
        <% if @european_countries_with_population.present? %>
          <div class="border-t border-black pt-4">
            <h4 class="font-mono text-xs uppercase tracking-brutal text-black/50 mb-4">Population Distribution</h4>
            <div class="space-y-1 max-h-80 overflow-y-auto">
              <% @european_countries_with_population.each do |country| %>
                <div class="flex items-center justify-between py-2 border-b border-black/10 hover:bg-[#F5F5F5] transition-colors">
                  <span class="font-mono text-sm"><%= country[:name] %></span>
                  <div class="flex items-center gap-4">
                    <span class="font-mono text-xs text-black/50"><%= number_to_human(country[:population], precision: 2, format: '%n%u', units: { million: 'M', billion: 'B' }) %></span>
                    <span class="font-mono text-xs font-bold text-[#0066FF] w-12 text-right"><%= number_to_percentage(country[:percentage], precision: 1) %></span>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
      
      <div class="border-2 border-black border-l-0 p-8">
        <h3 class="font-mono text-sm uppercase tracking-brutal font-bold mb-6 pb-4 border-b border-black">Why These Countries?</h3>
        <div class="space-y-6">
          <div class="border-l-2 border-[#0066FF] pl-4">
            <div class="font-mono text-xs uppercase tracking-brutal text-[#0066FF] mb-2">Geographic Definition</div>
            <p class="text-sm text-black/60">All countries geographically located in Europe, including both EU and non-EU nations</p>
          </div>
          
          <div class="border-l-2 border-black pl-4">
            <div class="font-mono text-xs uppercase tracking-brutal mb-2">Transcontinental Countries</div>
            <p class="text-sm text-black/60">For Russia and Turkey, we count only the European portion of their population: ~77% of Russia's population lives in European Russia, and ~14% lives in European Turkey (Thrace)</p>
          </div>
          
          <div class="border-l-2 border-black pl-4">
            <div class="font-mono text-xs uppercase tracking-brutal mb-2">Comprehensive Coverage</div>
            <p class="text-sm text-black/60">From large nations like Germany and France to small states like Monaco and San Marino</p>
          </div>
          
          <div class="border-l-2 border-black/50 pl-4">
            <div class="font-mono text-xs uppercase tracking-brutal mb-2">Data Availability</div>
            <p class="text-sm text-black/60">Countries with reliable data from authoritative sources</p>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Europe Map - Using actual geographic SVG paths -->
    <div class="border-2 border-black border-t-0 p-8">
      <h3 class="font-mono text-sm uppercase tracking-brutal font-bold mb-6 pb-4 border-b border-black">European Countries Map</h3>
      <p class="font-mono text-xs text-black/60 mb-6">Geographic representation of the 50 countries included in our European aggregate calculations.</p>
      <div class="flex justify-center">
        <div class="relative w-full max-w-4xl">
          <!-- Actual Geographic Map of Europe -->
          <%= render 'shared/europe_map' %>
          
          <!-- Legend -->
          <div class="flex justify-center gap-8 mt-4 pt-4 border-t border-black/20">
            <div class="flex items-center gap-2">
              <div class="w-4 h-4 bg-[#0066FF] border border-black"></div>
              <span class="font-mono text-xs">European Countries (100%)</span>
            </div>
            <div class="flex items-center gap-2">
              <div class="w-4 h-4 bg-[#0066FF]/75 border border-black"></div>
              <span class="font-mono text-xs">Transcontinental (RU 77%, TR 14%, AZ 30%)</span>
            </div>
          </div>
        </div>
      </div>
      <p class="font-mono text-xs text-center text-black/50 mt-4">50 countries included • Transcontinental countries shown with European population percentage</p>
    </div>
  </section>

  <!-- Calculation Methods Section -->
  <section class="py-16 border-b-2 border-black">
    <div class="flex items-center gap-6 mb-12">
      <span class="font-mono text-xs uppercase tracking-brutal bg-black text-white px-3 py-1">02</span>
      <h2 class="text-4xl font-black tracking-tighter">CALCULATION METHODS</h2>
    </div>

    <!-- Population Calculation -->
    <div class="border-2 border-black p-8 mb-8">
      <div class="flex items-start gap-8 mb-8">
        <div class="font-mono text-6xl font-bold text-black/10">Σ</div>
        <div>
          <h3 class="text-2xl font-black tracking-tight mb-2">Population (Simple Sum)</h3>
          <p class="text-black/60">The total population of Europe is calculated by summing all individual country populations.</p>
        </div>
      </div>
      
      <div class="bg-black text-white p-6 font-mono text-sm mb-8">
        <div class="text-[#0066FF] text-xs uppercase tracking-brutal mb-2">Formula</div>
        Europe Population = Σ(Population of each European country)
      </div>

      <% if @population_data && !@population_data[:error] && @population_data[:countries]['europe'] %>
        <div class="grid md:grid-cols-2 gap-0">
          <div class="border-2 border-black p-6">
            <div class="font-mono text-xs uppercase tracking-brutal text-black/50 mb-2">Total Europe Population (<%= @population_data[:year] %>)</div>
            <div class="font-mono text-5xl font-bold text-[#0066FF]">
              <%= number_with_delimiter((@population_data[:countries]['europe'][:value].to_i / 1_000_000.0).round(1)) %>M
            </div>
            <div class="font-mono text-xs text-black/40 mt-2">
              <%= number_with_delimiter(@population_data[:countries]['europe'][:value].to_i) %> people
            </div>
          </div>
          <div class="border-2 border-black border-l-0 p-6">
            <div class="font-mono text-xs uppercase tracking-brutal text-black/50 mb-2">Countries Included</div>
            <div class="font-mono text-5xl font-bold">
              <%= @european_countries.size %>
            </div>
            <div class="font-mono text-xs text-black/40 mt-2">European nations</div>
          </div>
        </div>
        
        <% if @population_data[:european_countries] %>
          <details class="mt-6">
            <summary class="cursor-pointer font-mono text-sm uppercase tracking-brutal hover:text-[#0066FF] transition-colors">
              ▼ View breakdown by country
            </summary>
            <div class="mt-4 grid md:grid-cols-3 gap-2 max-h-96 overflow-y-auto border-t-2 border-black pt-4">
              <% @population_data[:european_countries].sort.each do |country| %>
                <% if @population_data[:countries][country] %>
                  <div class="flex justify-between items-center p-2 bg-[#F5F5F5] font-mono text-xs">
                    <span><%= EuropeanCountriesHelper.country_name(country) %></span>
                    <span class="font-bold">
                      <%= number_with_delimiter((@population_data[:countries][country][:value].to_i / 1_000_000.0).round(1)) %>M
                    </span>
                  </div>
                <% end %>
              <% end %>
            </div>
          </details>
        <% end %>
      <% end %>
    </div>

    <!-- GDP Calculation -->
    <div class="border-2 border-black p-8 mb-8">
      <div class="flex items-start gap-8 mb-8">
        <div class="font-mono text-6xl font-bold text-black/10">$</div>
        <div>
          <h3 class="text-2xl font-black tracking-tight mb-2">GDP per Capita PPP (Population-Weighted)</h3>
          <p class="text-black/60">Purchasing power parity adjusted, weighted by population to reflect the true average European experience.</p>
        </div>
      </div>
      
      <div class="space-y-2 mb-8">
        <div class="bg-black text-white p-4 font-mono text-sm">
          <span class="text-[#0066FF]">Step 1:</span> Country Total GDP = GDP per capita × Population
        </div>
        <div class="bg-black text-white p-4 font-mono text-sm">
          <span class="text-[#0066FF]">Step 2:</span> Europe Total GDP = Σ(Country Total GDP)
        </div>
        <div class="bg-black text-white p-4 font-mono text-sm">
          <span class="text-[#0066FF]">Step 3:</span> Europe GDP per capita = Europe Total GDP ÷ Europe Population
        </div>
      </div>

      <div class="border-2 border-black p-6 bg-[#F5F5F5] mb-8">
        <h4 class="font-mono text-sm uppercase tracking-brutal font-bold mb-4">Why Population-Weighted?</h4>
        <div class="space-y-3 text-sm text-black/70">
          <div class="flex items-start gap-3">
            <span class="text-[#0066FF] font-bold">—</span>
            <span><strong class="text-black">Accurate representation:</strong> Reflects that Germany's economy affects more people than Luxembourg's</span>
          </div>
          <div class="flex items-start gap-3">
            <span class="text-[#0066FF] font-bold">—</span>
            <span><strong class="text-black">Fair comparison:</strong> Comparable to how USA, China, and India report national averages</span>
          </div>
          <div class="flex items-start gap-3">
            <span class="text-[#0066FF] font-bold">—</span>
            <span><strong class="text-black">Realistic picture:</strong> Shows the economic reality for the average European resident</span>
          </div>
        </div>
      </div>

      <% if @gdp_data && !@gdp_data[:error] && @gdp_data[:countries]['europe'] %>
        <div class="grid md:grid-cols-2 gap-0 mb-8">
          <div class="border-2 border-black p-6">
            <div class="font-mono text-xs uppercase tracking-brutal text-black/50 mb-2">Europe GDP per Capita PPP (<%= @gdp_data[:year] %>)</div>
            <div class="font-mono text-5xl font-bold text-[#0066FF]">
              $<%= number_with_delimiter(@gdp_data[:countries]['europe'][:value].round(0)) %>
            </div>
            <div class="font-mono text-xs text-black/40 mt-2">
              <% if @gdp_data[:countries]['europe'][:calculated] %>
                Calculated from <%= @european_countries.size %> countries
              <% else %>
                From database
              <% end %>
            </div>
          </div>
          <div class="border-2 border-black border-l-0 p-6">
            <div class="font-mono text-xs uppercase tracking-brutal text-black/50 mb-2">Comparison with USA</div>
            <% if @gdp_data[:countries]['usa'] %>
              <div class="font-mono text-5xl font-bold">
                <%= ((@gdp_data[:countries]['europe'][:value] / @gdp_data[:countries]['usa'][:value]) * 100).round(1) %>%
              </div>
              <div class="font-mono text-xs text-black/40 mt-2">
                of US GDP per capita ($<%= number_with_delimiter(@gdp_data[:countries]['usa'][:value].round(0)) %>)
              </div>
            <% else %>
              <div class="font-mono text-sm text-black/50">USA data not available</div>
            <% end %>
          </div>
        </div>

        <!-- Detailed Calculation -->
        <% if @gdp_data[:european_countries] && @population_data[:countries] %>
          <details class="border-2 border-black">
            <summary class="cursor-pointer p-4 font-mono text-sm uppercase tracking-brutal hover:bg-[#F5F5F5] transition-colors">
              ▼ View detailed calculation (All <%= @european_countries.size %> Countries)
            </summary>
            <div class="p-6 border-t-2 border-black bg-[#F5F5F5]">
              <% 
                available_gdp_keys = (@gdp_data[:countries] || {}).keys
                available_pop_keys = (@population_data[:countries] || {}).keys
                european_keys = EuropeanCountriesHelper.all_european_countries
                all_countries = (available_gdp_keys & available_pop_keys & european_keys)
                  .sort_by { |c| -((@gdp_data[:countries][c][:value]) * (@population_data[:countries][c][:value])) }
                
                total_weighted_gdp = 0
                total_population = 0
                
                all_countries.each do |country|
                  gdp = @gdp_data[:countries][country][:value]
                  pop = @population_data[:countries][country][:value]
                  weighted = gdp * pop
                  total_weighted_gdp += weighted
                  total_population += pop
                end
              %>
              
              <div class="font-mono text-xs space-y-4">
                <div class="bg-white border border-black p-4">
                  <div class="text-black/50 uppercase tracking-brutal mb-3">Step 1: GDP × Population</div>
                  <div class="max-h-64 overflow-y-auto space-y-1">
                    <% all_countries.each_with_index do |country, index| %>
                      <% 
                        gdp = @gdp_data[:countries][country][:value]
                        pop = @population_data[:countries][country][:value]
                        weighted = gdp * pop
                      %>
                      <div class="flex justify-between items-center py-1 border-b border-black/10 hover:bg-[#F5F5F5]">
                        <span class="text-black/40 w-6"><%= index + 1 %>.</span>
                        <span class="flex-grow"><%= EuropeanCountriesHelper.country_name(country) %></span>
                        <span class="text-right text-black/50">
                          $<%= number_with_delimiter(gdp.round(0)) %> × <%= number_to_human(pop, precision: 2) %> 
                          = <span class="font-bold text-[#0066FF]">$<%= number_to_human(weighted, precision: 3, format: '%n%u', units: { thousand: 'K', million: 'M', billion: 'B', trillion: 'T' }) %></span>
                        </span>
                      </div>
                    <% end %>
                  </div>
                </div>
                
                <div class="bg-white border border-black p-4">
                  <div class="text-black/50 uppercase tracking-brutal mb-2">Step 2: Sum</div>
                  <div>
                    Total weighted GDP: 
                    <span class="font-bold text-[#0066FF]">
                      $<%= number_to_human(@gdp_data[:total_weighted_gdp] || total_weighted_gdp, precision: 3, format: '%n%u', units: { thousand: 'K', million: 'M', billion: 'B', trillion: 'T', quadrillion: 'Q' }) %>
                    </span>
                  </div>
                </div>
                
                <div class="bg-white border border-black p-4">
                  <div class="text-black/50 uppercase tracking-brutal mb-2">Step 3: Divide</div>
                  <div class="space-y-2">
                    <div>Europe Population: <span class="font-bold"><%= number_to_human(@population_data.dig(:countries, 'europe', :value) || 0, precision: 3) %></span></div>
                    <div class="pt-2 border-t border-black">
                      $<%= number_to_human(@gdp_data[:total_weighted_gdp] || total_weighted_gdp, precision: 3, format: '%n%u', units: { quadrillion: 'Q', trillion: 'T' }) %> 
                      ÷ <%= number_to_human(@population_data.dig(:countries, 'europe', :value) || 0, precision: 3) %>
                      = <span class="font-bold text-[#0066FF] text-lg">$<%= number_with_delimiter((@gdp_data.dig(:countries, 'europe', :value) || 0).round(0)) %></span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </details>
        <% end %>
      <% end %>
    </div>

    <!-- Other Metrics -->
    <div class="border-2 border-black p-8">
      <div class="flex items-start gap-8 mb-8">
        <div class="font-mono text-6xl font-bold text-black/10">%</div>
        <div>
          <h3 class="text-2xl font-black tracking-tight mb-2">Other Metrics</h3>
          <p class="text-black/60">Development indicators like child mortality and electricity access use population-weighted averages.</p>
        </div>
      </div>
      
      <div class="bg-black text-white p-6 font-mono text-sm mb-8">
        <div class="text-[#0066FF] text-xs uppercase tracking-brutal mb-2">Standard Formula</div>
        Europe Average = Σ(Country Value × Country Population) ÷ Europe Total Population
      </div>

      <div class="grid md:grid-cols-2 gap-0">
        <% if @child_mortality_data && !@child_mortality_data[:error] && @child_mortality_data[:countries]['europe'] %>
          <div class="border-2 border-black p-6">
            <div class="font-mono text-xs uppercase tracking-brutal text-black/50 mb-2">Child Mortality Rate (<%= @child_mortality_data.dig(:countries, 'europe', :year) || '-' %>)</div>
            <div class="font-mono text-4xl font-bold text-[#0066FF]">
              <%= @child_mortality_data[:countries]['europe'][:value].round(2) %>%
            </div>
            <div class="font-mono text-xs text-black/40 mt-2">
              Deaths per 100 live births (under age 5)
            </div>
          </div>
        <% end %>

        <% if @electricity_access_data && !@electricity_access_data[:error] && @electricity_access_data[:countries]['europe'] %>
          <div class="border-2 border-black <%= @child_mortality_data ? 'border-l-0' : '' %> p-6">
            <div class="font-mono text-xs uppercase tracking-brutal text-black/50 mb-2">Electricity Access (<%= @electricity_access_data.dig(:countries, 'europe', :year) || '-' %>)</div>
            <div class="font-mono text-4xl font-bold text-[#0066FF]">
              <%= @electricity_access_data[:countries]['europe'][:value].round(1) %>%
            </div>
            <div class="font-mono text-xs text-black/40 mt-2">
              Population with electricity access
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </section>

  <!-- Data Gap Handling Section -->
  <section class="py-16 border-b-2 border-black">
    <div class="flex items-center gap-6 mb-12">
      <span class="font-mono text-xs uppercase tracking-brutal bg-black text-white px-3 py-1">03</span>
      <h2 class="text-4xl font-black tracking-tighter">HANDLING DATA GAPS</h2>
    </div>

    <div class="grid md:grid-cols-2 gap-0 mb-8">
      <div class="border-2 border-black p-8">
        <h3 class="font-mono text-sm uppercase tracking-brutal font-bold mb-6 pb-4 border-b border-black">The Challenge</h3>
        <p class="text-black/60 mb-6">
          Real-world data is rarely complete. Countries report statistics at different intervals, and some years may have 
          data for only a subset of European nations.
        </p>
        <div class="border-l-2 border-[#FFCC00] pl-4 bg-[#FFCC00]/10 p-4">
          <div class="font-mono text-xs uppercase tracking-brutal mb-2">Example</div>
          <p class="text-sm text-black/70">
            For homicide rates in 2024, we might have fresh data from only 15 of 50 European countries. 
            Excluding the others would bias the aggregate toward countries that happen to report more frequently.
          </p>
        </div>
      </div>
      
      <div class="border-2 border-black border-l-0 p-8">
        <h3 class="font-mono text-sm uppercase tracking-brutal font-bold mb-6 pb-4 border-b border-black">Our Solution</h3>
        <div class="space-y-6">
          <div class="border-l-2 border-[#0066FF] pl-4">
            <div class="font-mono text-xs uppercase tracking-brutal text-[#0066FF] mb-2">Forward-Fill</div>
            <p class="text-sm text-black/60">
              When a country lacks data for a specific year, we use the most recent available value. 
              This assumes metrics change gradually rather than disappearing.
            </p>
          </div>
          
          <div class="border-l-2 border-black pl-4">
            <div class="font-mono text-xs uppercase tracking-brutal mb-2">Population-Based Coverage</div>
            <p class="text-sm text-black/60">
              We track what percentage of Europe's <strong>population</strong> has actual data vs. forward-filled values. 
              This ensures large countries like Germany, France, Russia, Italy, and Poland are properly represented—
              if major countries are missing, the aggregate is marked as incomplete.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Visual Indicators -->
    <div class="border-2 border-black p-8 mb-8">
      <h3 class="font-mono text-sm uppercase tracking-brutal font-bold mb-6 pb-4 border-b border-black">Understanding Visual Indicators</h3>
      
      <div class="grid md:grid-cols-2 gap-8">
        <div>
          <h4 class="font-mono text-sm font-bold mb-4">In Charts</h4>
          <div class="space-y-4">
            <div class="flex items-center gap-4 p-4 bg-[#F5F5F5]">
              <div class="w-24 h-1 bg-[#0066FF]"></div>
              <span class="text-sm text-black/70"><strong>Solid line:</strong> ≥70% of European population has data for that year</span>
            </div>
            <div class="flex items-center gap-4 p-4 bg-[#F5F5F5]">
              <div class="w-24 h-0 border-t-2 border-dashed border-[#0066FF]"></div>
              <span class="text-sm text-black/70"><strong>Dotted line:</strong> <70% of population has data (incomplete)</span>
            </div>
          </div>
        </div>
        
        <div>
          <h4 class="font-mono text-sm font-bold mb-4">In Data Tables</h4>
          <div class="space-y-4">
            <div class="flex items-center gap-4 p-4 bg-[#F5F5F5]">
              <span class="text-[#0066FF] font-bold font-mono">42,500</span>
              <span class="text-sm text-black/70">Normal value: Complete data</span>
            </div>
            <div class="flex items-center gap-4 p-4 bg-[#F5F5F5]">
              <span class="text-[#0066FF] font-bold font-mono border-b border-dashed border-current">42,500<sup class="text-xs">*</sup></span>
              <span class="text-sm text-black/70">Asterisk: Incomplete data (<70% population coverage)</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Thresholds -->
    <div class="border-2 border-black p-8 bg-[#F5F5F5]">
      <h3 class="font-mono text-sm uppercase tracking-brutal font-bold mb-6">Coverage Thresholds</h3>
      <div class="grid md:grid-cols-3 gap-6">
        <div class="border-2 border-black bg-white p-6">
          <div class="font-mono text-4xl font-bold text-[#FF0000] mb-2">&lt;30%</div>
          <div class="font-mono text-xs uppercase tracking-brutal text-black/50 mb-2">Minimum Threshold</div>
          <p class="text-sm text-black/60">
            If countries representing fewer than 30% of European population have data (current or forward-filled), 
            we don't calculate an aggregate at all—the data would be too unreliable.
          </p>
        </div>
        
        <div class="border-2 border-black bg-white p-6">
          <div class="font-mono text-4xl font-bold text-[#FFCC00] mb-2">30-69%</div>
          <div class="font-mono text-xs uppercase tracking-brutal text-black/50 mb-2">Incomplete</div>
          <p class="text-sm text-black/60">
            Aggregate is calculated but marked as incomplete with dotted lines 
            in charts and asterisks in tables.
          </p>
        </div>
        
        <div class="border-2 border-black bg-white p-6">
          <div class="font-mono text-4xl font-bold text-[#00CC66] mb-2">≥70%</div>
          <div class="font-mono text-xs uppercase tracking-brutal text-black/50 mb-2">Complete</div>
          <p class="text-sm text-black/60">
            Displayed normally with solid lines. This represents a reliable 
            aggregate covering at least 70% of Europe's population.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Data Sources Section -->
  <section class="py-16 border-b-2 border-black">
    <div class="flex items-center gap-6 mb-12">
      <span class="font-mono text-xs uppercase tracking-brutal bg-black text-white px-3 py-1">04</span>
      <h2 class="text-4xl font-black tracking-tighter">DATA SOURCES</h2>
    </div>
    
    <div class="grid md:grid-cols-2 gap-0">
      <div class="border-2 border-black p-8">
        <h3 class="font-mono text-sm uppercase tracking-brutal font-bold mb-6 pb-4 border-b border-black">Our World in Data</h3>
        <p class="text-black/60 mb-6">
          Primary source for most metrics. A scientific online publication that focuses on large global problems.
        </p>
        <a href="https://ourworldindata.org" target="_blank" rel="noopener" 
           class="inline-flex items-center gap-2 font-mono text-sm uppercase tracking-brutal underline underline-offset-4 hover:text-[#0066FF] transition-colors">
          ourworldindata.org
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
          </svg>
        </a>
      </div>

      <div class="border-2 border-black border-l-0 p-8">
        <h3 class="font-mono text-sm uppercase tracking-brutal font-bold mb-6 pb-4 border-b border-black">Quality Standards</h3>
        <ul class="space-y-3 text-sm text-black/60">
          <li class="flex items-start gap-3">
            <span class="text-[#0066FF] font-bold">—</span>
            <span>Data from peer-reviewed sources</span>
          </li>
          <li class="flex items-start gap-3">
            <span class="text-[#0066FF] font-bold">—</span>
            <span>Regularly updated with latest figures</span>
          </li>
          <li class="flex items-start gap-3">
            <span class="text-[#0066FF] font-bold">—</span>
            <span>Transparent methodology and sources</span>
          </li>
          <li class="flex items-start gap-3">
            <span class="text-[#0066FF] font-bold">—</span>
            <span>Consistent definitions across countries</span>
          </li>
        </ul>
      </div>
    </div>
  </section>

  <!-- Transparency Section -->
  <section class="py-16">
    <div class="flex items-center gap-6 mb-12">
      <span class="font-mono text-xs uppercase tracking-brutal bg-black text-white px-3 py-1">05</span>
      <h2 class="text-4xl font-black tracking-tighter">OPEN SOURCE</h2>
    </div>
    
    <div class="border-2 border-black p-8 bg-[#F5F5F5]">
      <p class="text-lg text-black/70 mb-8 max-w-2xl">
        This project is <strong class="text-black">fully open source</strong>. You can review our code, data processing methods, 
        and contribute improvements on GitHub.
      </p>
      <div class="flex flex-wrap gap-4">
        <%= link_to "https://github.com/duartemartins/europeversus", target: "_blank", rel: "noopener",
            class: "inline-flex items-center gap-4 bg-black text-white px-8 py-4 font-mono text-sm uppercase tracking-brutal hover:bg-[#0066FF] transition-colors" do %>
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
            <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path>
          </svg>
          View on GitHub
        <% end %>
        
        <%= link_to root_path,
            class: "inline-flex items-center gap-4 border-2 border-black bg-white px-8 py-4 font-mono text-sm uppercase tracking-brutal hover:bg-black hover:text-white transition-colors" do %>
          ← Back to Home
        <% end %>
      </div>
    </div>
  </section>
</div>
